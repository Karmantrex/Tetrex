function deleteColumnsWithoutDataBelowHeader() {
  const sheet = SpreadsheetApp.getActiveSheet();
  const lastRow = sheet.getLastRow();
  const lastCol = sheet.getLastColumn();
  if (lastRow < 2) return; // nothing below header anyway

  // walk right-to-left so indexes don't shift
  for (let col = lastCol; col >= 1; col--) {
    // get *display* values so formula "" counts as blank
    const rng = sheet.getRange(2, col, lastRow - 1, 1);
    const values = rng.getDisplayValues().map(r => (r[0] ?? "").trim());

    const allBlank = values.every(v => v === "");
    if (allBlank) {
      sheet.deleteColumn(col);
    }
  }
  SpreadsheetApp.flush();
}
