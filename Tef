function deleteEmptyColumns() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const range = sheet.getDataRange();
  const values = range.getValues();
  const numRows = values.length;
  const numCols = values[0].length;

  // Go from last column to first to avoid index shifting
  for (let col = numCols - 1; col >= 0; col--) {
    let isEmpty = true;
    for (let row = 0; row < numRows; row++) {
      if (values[row][col] !== "" && values[row][col] !== null) {
        isEmpty = false;
        break;
      }
    }
    if (isEmpty) {
      sheet.deleteColumn(col + 1); // +1 because Sheets uses 1-based indexing
    }
  }

  SpreadsheetApp.flush(); // Optional but ensures all changes are applied
}
