function deleteCompletelyEmptyColumns() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const lastRow = sheet.getLastRow();
  const lastCol = sheet.getLastColumn();

  // Loop backwards so deleting doesnâ€™t mess up the indexes
  for (let col = lastCol; col >= 1; col--) {
    const range = sheet.getRange(1, col, lastRow); // entire column
    const values = range.getValues().flat(); // flatten into a 1D array
    const hasData = values.some(v => v !== "" && v !== null);

    if (!hasData) {
      sheet.deleteColumn(col);
    }
  }
}
